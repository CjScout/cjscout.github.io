<!DOCTYPE html>
<html>
<head>
  <title>Productivity Dashboard</title>
  <script src="https://apis.google.com/js/platform.js" async defer></script>
  <meta name="google-signin-client_id" content="890079625525-6alpvv95rigf3ijdqglc9l5o5olc3ijs.apps.googleusercontent.com">
  <style>
    /* Add your custom CSS styles here */
  </style>
</head>
<body>
  <h1>Productivity Dashboard</h1>

  <!-- Google Sign-In button -->
  <div class="g-signin2" data-onsuccess="onSignIn"></div>

  <!-- Placeholder elements for displaying user information -->
  <div id="user-info" style="display: none;">
    <img id="user-picture" src="" alt="User Picture">
    <h3 id="user-name"></h3>
    <p id="user-email"></p>
  </div>

  <!-- Google Calendar integration -->
  <div id="calendar-events" style="display: none;">
    <h2>Upcoming Events</h2>
    <ul id="event-list"></ul>
  </div>

  <!-- Google Drive integration -->
  <div id="drive-files" style="display: none;">
    <h2>Recent Files</h2>
    <ul id="file-list"></ul>
  </div>

  <!-- Google Tasks integration -->
  <div id="tasks-list" style="display: none;">
    <h2>Tasks</h2>
    <ul id="task-list"></ul>
  </div>

  <script>
    // Function to initialize Google Sign-In
    function onSignIn(googleUser) {
      var profile = googleUser.getBasicProfile();

      // Display user information
      document.getElementById('user-picture').src = profile.getImageUrl();
      document.getElementById('user-name').textContent = profile.getName();
      document.getElementById('user-email').textContent = profile.getEmail();

      // Show the relevant dashboard sections
      document.getElementById('user-info').style.display = 'block';
      document.getElementById('calendar-events').style.display = 'block';
      document.getElementById('drive-files').style.display = 'block';
      document.getElementById('tasks-list').style.display = 'block';

      // Fetch Google Calendar events
      gapi.client.load('calendar', 'v3', function() {
        var request = gapi.client.calendar.events.list({
          'calendarId': 'primary',
          'timeMin': (new Date()).toISOString(),
          'showDeleted': false,
          'singleEvents': true,
          'maxResults': 5,
          'orderBy': 'startTime'
        });

        request.execute(function(response) {
          var events = response.items;

          if (events.length > 0) {
            for (var i = 0; i < events.length; i++) {
              var event = events[i];
              var eventItem = document.createElement('li');
              eventItem.appendChild(document.createTextNode(event.summary));
              document.getElementById('event-list').appendChild(eventItem);
            }
          } else {
            document.getElementById('event-list').textContent = 'No upcoming events.';
          }
        });
      });

      // Fetch Google Drive recent files
      gapi.client.load('drive', 'v3', function() {
        var request = gapi.client.drive.files.list({
          'pageSize': 5,
          'fields': 'files(name)'
        });

        request.execute(function(response) {
          var files = response.files;

          if (files && files.length > 0) {
            for (var i = 0; i < files.length; i++) {
              var file = files[i];
              var fileItem = document.createElement('li');
              fileItem.appendChild(document.createTextNode(file.name));
              document.getElementById('file-list').appendChild(fileItem);
            }
          } else {
            document.getElementById('file-list').textContent = 'No recent files.';
          }
        });
      });

      // Fetch Google Tasks
      gapi.client.load('tasks', 'v1', function() {
        var request = gapi.client.tasks.tasklists.list({});

        request.execute(function(response) {
          var taskLists = response.items;

          if (taskLists && taskLists.length > 0) {
            var taskList = taskLists[0];
            var request = gapi.client.tasks.tasks.list({
              'tasklist': taskList.id
            });

            request.execute(function(response) {
              var tasks = response.items;

              if (tasks && tasks.length > 0) {
                for (var i = 0; i < tasks.length; i++) {
                  var task = tasks[i];
                  var taskItem = document.createElement('li');
                  taskItem.appendChild(document.createTextNode(task.title));
                  document.getElementById('task-list').appendChild(taskItem);
                }
              } else {
                document.getElementById('task-list').textContent = 'No tasks.';
              }
            });
          } else {
            document.getElementById('task-list').textContent = 'No task lists found.';
          }
        });
      });
    }
  </script>

  <!-- Load the Google API client library -->
  <script src="https://apis.google.com/js/api.js"></script>
  <script>
    function handleClientLoad() {
      gapi.load('client:auth2', initClient);
    }

    function initClient() {
      gapi.client.init({
        apiKey: 'AIzaSyClfgsPkGngmxJWNQMCaOLulz2Yom64ePQ',
        clientId: '890079625525-6alpvv95rigf3ijdqglc9l5o5olc3ijs.apps.googleusercontent.com',
        discoveryDocs: ['https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest',
                        'https://www.googleapis.com/discovery/v1/apis/drive/v3/rest',
                        'https://www.googleapis.com/discovery/v1/apis/tasks/v1/rest'],
        scope: 'https://www.googleapis.com/auth/calendar.readonly https://www.googleapis.com/auth/drive.readonly https://www.googleapis.com/auth/tasks.readonly'
      }).then(function() {
        gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus);
        updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
      });
    }

    function updateSigninStatus(isSignedIn) {
      if (isSignedIn) {
        onSignIn(gapi.auth2.getAuthInstance().currentUser.get());
      }
    }
  </script>

  <!-- Call the handleClientLoad function to initialize the Google API client library -->
  <script src="https://apis.google.com/js/client.js?onload=handleClientLoad"></script>
</body>
</html>
